//
//  ExploreViewController.m
//  fmapp
//
//  Created by 李 喻辉 on 14-5-11.
//  Copyright (c) 2014年 yk. All rights reserved.
//

#import "ExploreViewController.h"
#import "QuickDealWithAccidentController.h"
#import "SearchAndReceiveViewController.h"
#import "ExposureFreshThingViewController.h"
#import "BroadcastinStationActivityView.h"
#import "UserActivityListViewController.h"
#import "DisclaimerStatementController.h"
#import "SearchAndReceiveViewController.h"
#import "MoreForExploreViewController.h"
#import "MultipleBreakRulesMainView.h"
#import "TrafficPoliceMessageViewController.h"
#import "LuckUserGetCodewordsViewController.h"
#import "AnnouncementViewController.h"
#import "RandomPhotoViewController.h"
#import "CityFreeRideMainListView.h"
#import "UserShakeMainController.h"
#import "CurrentUserInformation.h"
#import "ShareWebViewController.h"
#import "FMTabBarController.h"
#import "NearbyMerchantList.h"
#import "LoginController.h"
#import "AppDelegate.h"
#import "FMSettings.h"

#define ViewSizeWidth   self.view.bounds.size.width

#define KContentLeftSizeWidth 60.0f                 //标题文本距离左侧的边距
#define kScrollViewTag 10000                        //ScrollView视图定位
#define KUserShakeAndShakeButtonTag 110111          //摇一摇按键定位
#define KRadioActivityButtonTag 110112              //电台活动按键定位
#define KMoreButtonTag 110184                       //更多导航按键
#define kHighSpeedRoadcoditionButtonTag 110117      //高速路况按键定位
#define kQuickDealWthAccidentButtonTag 110115       //事故快处按键定位

#define KstationInformaButtonTag 1101118            //电台资讯按键定位
#define KUserActivityLisButtonTag 110119            //活动召集令按键定位
#define kNearbyShopButtonTag 110121                 //周边商户按键定位

#define KPushShakeAndShakeNewPrizeImageTag          190111          ///摇一摇奖品列表新增提示；
#define KPushRadioActivityNewInforImageTag          190112          ///电台活动新增提示；
#define KPushRadioInformationNewInforImageTag       190113          ///电台资讯新增内容
#define KPushSecondHandCarResultImageViewTag        190114          ///二手车评估结果提示内容
#define KPushSpecialBusinessNewImageViewTag         190115          ///新增特约商户提醒内容


@interface ExploreViewController ()

//- (void)initWithUserReadShakePrizeListNotification:(NSNotification *) notification;
///二手车苹果结果查看通知
- (void)initWithUSerSecondHandCarResultInforNotification:(NSNotification *) notification;
/** 初始化探索界面控件
 
 *@return void
 **/
- (void)initWithExploreViewControllerFrame;

/** 初始化用户探索按键操作事件
 
 *@return void
 **/
- (void)initWithUserExploreButtnClicked:(id)sender;
@end

@implementation ExploreViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        self.enableCustomNavbarBackButton = FALSE;
        //初始化主题模式
    }
    return self;
}

- (void)loadView{
    self.view = [[UIView alloc] initWithFrame:HUIApplicationFrame()];
    self.view.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
    self.view.backgroundColor = KDefaultOrNightScrollViewColor;
}

- (void)viewDidLoad
{
    
    // Do any additional setup after loading the view.
#if defined (WH)
    [self settingNavTitle:@"896车友俱乐部"];
#else
    [self settingNavTitle:@"探索"];
#endif
    [super viewDidLoad];
    
        ///初始化探索界面控件
    [self initWithExploreViewControllerFrame];
    
//    ///添加通知设置
//    [[NSNotificationCenter defaultCenter] addObserver: self
//                                             selector: @selector(initWithUserReadShakePrizeListNotification:)
//                                                 name: FMUserShakeAndShakePrizeListNotification
//                                               object: nil];
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(initWithUSerSecondHandCarResultInforNotification:)
                                                 name:FMUserSecondHandCarResultNotification
                                               object:nil];
    //主题通知
    [[NSNotificationCenter defaultCenter] addObserver: self
                                             selector: @selector(themeChangedNotification:)
                                                 name: FMThemeChangedNotification
                                               object: nil];
	
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

//夜间模式
-(void)ThemeForNight
{
    for(UIView *sc in self.view.subviews)
    {
        if([sc isKindOfClass:[UIScrollView class]])
        {
            sc.backgroundColor=KDefaultOrNightScrollViewColor;
            for(UIView *vc in sc.subviews)
            {
                vc.backgroundColor=KDefaultOrNightBackGroundColor;
                vc.layer.borderColor=[KDefaultOrNightSepratorColor CGColor];
                for(UIButton *btn in vc.subviews)
                {
                    if([btn isKindOfClass:[UIButton class]])
                    {
                        [btn setBackgroundImage:createImageWithColor(KDefaultOrNightBackGroundColor)
                                       forState:UIControlStateNormal];
                        [btn setBackgroundImage:createImageWithColor(KDefaultOrNightButtonHighlightColor)
                                       forState:UIControlStateHighlighted];
                        [btn.layer setBorderColor:[KDefaultOrNightSepratorColor CGColor]];
                        for(UILabel *label in btn.subviews)
                        {
                            if ([label isKindOfClass:[UILabel class]]) {
                                label.textColor=KDefaultOrNightTextColor;
                            }
                        }
                        int i=0;
                        for(UIImageView *image in btn.subviews)
                        {
                            if ([image isKindOfClass:[UIImageView class]]&&i==1) {
                                if (ThemeCategory==5) {
                                    image.alpha=0.5;
                                }
                                else
                                {
                                image.alpha=1;
                                }
                            }
                            i++;
                        }
                    }
                    for(UIView *v in vc.subviews)
                    {
                        if([v isKindOfClass:[UIView class]])
                        {
                            v.backgroundColor=KDefaultOrNightSepratorColor;
                        }
                    }
                    
                }
            }
        }
    }
}
- (void)viewWillAppear:(BOOL)animated{
    
    if(ThemeCategory==5)
    {
        [self ThemeForNight];
    }
    

        if (FMShareSetting.appPushRadioActivityBool ==YES || FMShareSetting.appPushPrizeListInforBool ==YES ) {
        AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
        FMTabBarController* tabControl = (FMTabBarController*)appDelegate.window.rootViewController;
        [tabControl showHintPoint:2 showOrHide:YES];
        
    }
    
    UIScrollView *mainScrollView = (UIScrollView *)[self.view viewWithTag:kScrollViewTag];
   
    
    UIButton *buttonShake = (UIButton *)[mainScrollView viewWithTag:KUserShakeAndShakeButtonTag];
    UIImageView *shakeNewImageView = (UIImageView *)[buttonShake viewWithTag:KPushShakeAndShakeNewPrizeImageTag];
    ///若有最新摇一摇奖品内容
    if (FMShareSetting.appPushPrizeListInforBool == YES) {
        if (!shakeNewImageView) {
            shakeNewImageView = [[UIImageView alloc]init];
            if (ThemeCategory==5) {
                shakeNewImageView.alpha=0.7;
            }
            [shakeNewImageView setFrame:CGRectMake((ViewSizeWidth-1)/3 - 20.0f, 15, 9.0f, 9.0f)];
            [shakeNewImageView setTag:KPushShakeAndShakeNewPrizeImageTag];
            [shakeNewImageView setImage:kImgHintPointImage];
            [buttonShake addSubview:shakeNewImageView];
        }
    }else{
        [shakeNewImageView setHidden:YES];
    }
    
    UIButton *buttonRadioActivity = (UIButton *)[mainScrollView viewWithTag:KRadioActivityButtonTag];
    UIImageView *radioActivityImageView = (UIImageView *)[buttonRadioActivity viewWithTag:KPushRadioActivityNewInforImageTag];
    ///若有最新电台活动内容
    if (FMShareSetting.appPushRadioActivityBool == YES) {
        if (!radioActivityImageView) {
            radioActivityImageView = [[UIImageView alloc]init];
            if (ThemeCategory==5) {
                radioActivityImageView.alpha=0.7;
            }
            [radioActivityImageView setFrame:CGRectMake((ViewSizeWidth-1)/3 - 20.0f, 15, 9.0f, 9.0f)];
            [radioActivityImageView setTag:KPushRadioActivityNewInforImageTag];
            [radioActivityImageView setImage:kImgHintPointImage];
            [buttonRadioActivity addSubview:radioActivityImageView];
        }
    }else{
        [radioActivityImageView setHidden:YES];
    }
    
    UIButton *buttonRadioInfor = (UIButton *)[mainScrollView viewWithTag:KstationInformaButtonTag];
    UIImageView *radioInforImageView = (UIImageView *)[buttonRadioInfor viewWithTag:KPushRadioInformationNewInforImageTag];
    ///若有最新电台公告内容
    if (FMShareSetting.appPushRadioAnnouncementBool == YES) {
        if (!radioInforImageView) {
            radioInforImageView = [[UIImageView alloc]init];
            if (ThemeCategory==5) {
                radioInforImageView.alpha=0.7;
            }

            [radioInforImageView setFrame:CGRectMake(ViewSizeWidth - 40.0f, 23.5, 9.0f, 9.0f)];
            [radioInforImageView setTag:KPushRadioInformationNewInforImageTag];
            [radioInforImageView setImage:kImgHintPointImage];
            [buttonRadioInfor addSubview:radioInforImageView];
        }
    }else{
        [radioInforImageView setHidden:YES];
    }
    
    
    ///获得最新二手车苹果结果内容通知
    UIButton *secondResultInfor = (UIButton *)[mainScrollView viewWithTag:KMoreButtonTag];
    UIImageView *secondResultImageView = (UIImageView *)[secondResultInfor viewWithTag:KPushSecondHandCarResultImageViewTag];
    if (FMShareSetting.appPushExploreSecondCarResultInforBool == YES) {
        if (!secondResultImageView) {
            secondResultImageView = [[UIImageView alloc]init];
            if (ThemeCategory==5) {
                secondResultImageView.alpha=0.7;
            }

            [secondResultImageView setFrame:CGRectMake((ViewSizeWidth-1)/3 - 20.0f, 15, 9.0f, 9.0f)];
            [secondResultImageView setTag:KPushSecondHandCarResultImageViewTag];
            [secondResultImageView setImage:kImgHintPointImage];
            [secondResultInfor addSubview:secondResultImageView];
        }
    }else{
        [secondResultImageView setHidden:YES];
    }
    ///获得最新特约商户相关内容通知提醒
    UIButton *specialBusinessInfor = (UIButton *)[mainScrollView viewWithTag:kNearbyShopButtonTag];
    UIImageView *specialBusinessImageView = (UIImageView *)[specialBusinessInfor viewWithTag:KPushSpecialBusinessNewImageViewTag];
    if (FMShareSetting.appPushExploreSpecialBusinessInforBool == YES) {
        if (!specialBusinessImageView) {
            specialBusinessImageView = [[UIImageView alloc]init];
            if (ThemeCategory==5) {
                specialBusinessImageView.alpha=0.7;
            }
            [specialBusinessImageView setFrame:CGRectMake(ViewSizeWidth - 40.0f, 23.5, 9.0f, 9.0f)];
            [specialBusinessImageView setTag:KPushSpecialBusinessNewImageViewTag];
            [specialBusinessImageView setImage:kImgHintPointImage];
            [specialBusinessInfor addSubview:specialBusinessImageView];
        }
    }else{
        [specialBusinessImageView setHidden:YES];
    }
}

#pragma mark -
#pragma mark - 初始化探索界面控件
- (void)initWithExploreViewControllerFrame{
    //滚动视图
    UIScrollView *mainScrollView = [[UIScrollView alloc] initWithFrame:self.view.bounds];
    mainScrollView.tag = kScrollViewTag;
    mainScrollView.backgroundColor = KDefaultOrNightScrollViewColor;
    mainScrollView.showsVerticalScrollIndicator = NO;
    mainScrollView.contentSize = CGSizeMake(ViewSizeWidth,self.view.bounds.size.height+90.0f);
    
    ///设置头部引导按键内容
    UIView *headerView = [[UIView alloc]initWithFrame:CGRectMake(0.0f, 15.0f, ViewSizeWidth, 80.0f)];
    //headerView.backgroundColor = [UIColor whiteColor];
    headerView.backgroundColor = KDefaultOrNightScrollViewColor;

    headerView.layer.borderWidth = 0.5f;
    headerView.layer.borderColor = [KDefaultOrNightSepratorColor CGColor];
    
    
    ///第一部分 摇一摇
    UIButton *userShakeButton = [UIButton buttonWithType:UIButtonTypeCustom];
    userShakeButton.tag = KUserShakeAndShakeButtonTag;
    
    
    [userShakeButton setBackgroundImage:createImageWithColor([UIColor whiteColor])
                               forState:UIControlStateNormal];

    [userShakeButton setBackgroundImage:createImageWithColor(KDefaultOrNightButtonHighlightColor)
                               forState:UIControlStateHighlighted];
    [userShakeButton setFrame:CGRectMake(0, 0.0f, (ViewSizeWidth-1)/3, 80.0f)];
    [userShakeButton addTarget:self action:@selector(initWithUserExploreButtnClicked:)
              forControlEvents:UIControlEventTouchUpInside];
    
    ////指示图片
    UIImageView *userShakeImageView = [[UIImageView alloc] initWithFrame:CGRectMake((userShakeButton.frame.size.width-38)/2, 10.0f, 38, 38)];
    userShakeImageView.image = [UIImage imageNamed:@"Explore_ShakeImage.png"];
    [userShakeButton addSubview:userShakeImageView];
    ////名称
    UILabel *userShakeLabel = [[UILabel alloc] initWithFrame:CGRectMake((userShakeButton.frame.size.width-69.3)/2,50, 69.3, 20.0f)];
    userShakeLabel.font = [UIFont systemFontOfSize:14.0f];
    userShakeLabel.textColor = KDefaultOrNightTextColor;
    userShakeLabel.textAlignment = NSTextAlignmentCenter;
    userShakeLabel.backgroundColor = [UIColor clearColor];
    userShakeLabel.text = @"摇一摇";
    [userShakeButton addSubview:userShakeLabel];
    [headerView addSubview:userShakeButton];
    
    ///设置分割线内容
    UIView  *splitLineView = [[UIView alloc]initWithFrame:CGRectMake((ViewSizeWidth-1)/3, 8.5f, 0.5f, 63.5)];
//    [splitLineView setBackgroundColor:[UIColor colorWithRed:231.0f/255.0f
//                                                      green:231.0f/255.0f
//                                                       blue:231.0f/255.0f
//                                                      alpha:1.0f]];
    [splitLineView setBackgroundColor:KDefaultOrNightSepratorColor];
    [headerView addSubview:splitLineView];
    
    ///第二部分 电台活动
    UIButton    *radioActivityButton = [UIButton buttonWithType:UIButtonTypeCustom];
    radioActivityButton.tag = KRadioActivityButtonTag;
//    [radioActivityButton setBackgroundImage:createImageWithColor([UIColor whiteColor])
//                                   forState:UIControlStateNormal];
    [radioActivityButton setBackgroundImage:createImageWithColor([UIColor whiteColor])
                                   forState:UIControlStateNormal];

    [radioActivityButton setBackgroundImage:createImageWithColor(KDefaultOrNightButtonHighlightColor)
                                   forState:UIControlStateHighlighted];
    [radioActivityButton setFrame:CGRectMake((ViewSizeWidth-1)/3+0.5, 0.0f,(ViewSizeWidth-1)/3, 80.0f)];
    [radioActivityButton addTarget:self action:@selector(initWithUserExploreButtnClicked:)
                  forControlEvents:UIControlEventTouchUpInside];
    
    ////指示图片
    UIImageView *radioActivityImageView = [[UIImageView alloc] initWithFrame:CGRectMake((radioActivityButton.frame.size.width-38)/2, 10.0f, 38, 38)];
    radioActivityImageView.image = [UIImage imageNamed:@"Explore_ActivityImage.png"];
    [radioActivityButton addSubview:radioActivityImageView];
    ////名称
    UILabel *radioActivityLabel = [[UILabel alloc] initWithFrame:CGRectMake((radioActivityButton.frame.size.width-69.3)/2,50, 69.3, 20.0f)];
    radioActivityLabel.font = [UIFont systemFontOfSize:14.0f];
    radioActivityLabel.textColor = KDefaultOrNightTextColor;
    radioActivityLabel.text = @"电台活动";
    [radioActivityLabel setTextAlignment:NSTextAlignmentCenter];
    radioActivityLabel.backgroundColor = [UIColor clearColor];
    [radioActivityButton addSubview:radioActivityLabel];
    //new
    //    UIImageView *radioActivityNewImageView = [[UIImageView alloc] initWithFrame:CGRectMake(260, 20, 26, 14)];
    //    radioActivityNewImageView.tag = KRadioActivityImageViewTag;
    //    radioActivityNewImageView.image = [UIImage imageNamed:@"Me_MyTrafficViolations_New.png"];
    //    radioActivityNewImageView.hidden = YES;
    //    [radioActivityButton addSubview:radioActivityNewImageView];
    [headerView addSubview:radioActivityButton];
    
    ///设置分割线内容
    UIView  *splitLineSecondView = [[UIView alloc]initWithFrame:CGRectMake((ViewSizeWidth-1)/3*2+0.5, 8.5f, 0.5f, 63.5)];
    [splitLineSecondView setBackgroundColor:KDefaultOrNightSepratorColor];
    [headerView addSubview:splitLineSecondView];
    
    
    ///第三部分 更多
    UIButton    *moreButton = [UIButton buttonWithType:UIButtonTypeCustom];
    moreButton.tag = KMoreButtonTag;
    [moreButton setBackgroundImage:createImageWithColor([UIColor whiteColor])
                          forState:UIControlStateNormal];
    [moreButton setBackgroundImage:createImageWithColor(KDefaultOrNightButtonHighlightColor)
                          forState:UIControlStateHighlighted];
    [moreButton setFrame:CGRectMake((ViewSizeWidth-1)/3*2+1, 0.0f, (ViewSizeWidth-1)/3, 80.0f)];
    [moreButton addTarget:self action:@selector(initWithUserExploreButtnClicked:)
         forControlEvents:UIControlEventTouchUpInside];
    
    ////指示图片
    UIImageView *moreImageView = [[UIImageView alloc] initWithFrame:CGRectMake((moreButton.frame.size.width-38)/2, 10.0f, 38, 38)];
//    float a=moreButton.frame.size.width-38;
    
    moreImageView.image = [UIImage imageNamed:@"Explore_MoreImage.png"];
    [moreButton addSubview:moreImageView];
    ////名称
    UILabel *moreButtonLabel = [[UILabel alloc] initWithFrame:CGRectMake((moreButton.frame.size.width-69.3)/2,50, 69.3, 20.0f)];
    moreButtonLabel.font = [UIFont systemFontOfSize:14.0f];
    moreButtonLabel.textColor = KDefaultOrNightTextColor;
    [moreButtonLabel setTextAlignment:NSTextAlignmentCenter];
    moreButtonLabel.backgroundColor = [UIColor clearColor];
    moreButtonLabel.text = @"更多";
    [moreButton addSubview:moreButtonLabel];
    [headerView addSubview:moreButton];
    
    [mainScrollView addSubview:headerView];
    
    
    ///////////////
    ///第二部分：高速路况、事故快处
    //////////////
    UIView *secondSectionView = [[UIView alloc] initWithFrame:CGRectMake(0, 120.0f, KProjectScreenWidth, 108.5)];
    //secondSectionView.backgroundColor = [UIColor whiteColor];
    secondSectionView.backgroundColor=KDefaultOrNightScrollViewColor;
    secondSectionView.layer.borderWidth = 0.5f;
    secondSectionView.layer.borderColor = [KDefaultOrNightSepratorColor CGColor];
    
    //第一行.高速路况
    UIButton *highSpeedRoadcoditionButton = [UIButton buttonWithType:UIButtonTypeCustom];
    highSpeedRoadcoditionButton.tag = kHighSpeedRoadcoditionButtonTag;
    [highSpeedRoadcoditionButton setBackgroundImage:createImageWithColor([UIColor whiteColor])
                                           forState:UIControlStateNormal];
    [highSpeedRoadcoditionButton setBackgroundImage:createImageWithColor(KDefaultOrNightButtonHighlightColor)
                                           forState:UIControlStateHighlighted];
    [highSpeedRoadcoditionButton setFrame:CGRectMake(0, 0.0f, KProjectScreenWidth, 54)];
    [highSpeedRoadcoditionButton addTarget:self action:@selector(initWithUserExploreButtnClicked:) forControlEvents:UIControlEventTouchUpInside];
    ////第二行 指示图片
    UIImageView *highSpeedRoadcoditionImageView = [[UIImageView alloc] initWithFrame:CGRectMake(15, 12.5f, 29, 29)];
    highSpeedRoadcoditionImageView.image = [UIImage imageNamed:@"Explore_HighSpeed.png"];
    [highSpeedRoadcoditionButton addSubview:highSpeedRoadcoditionImageView];
    ////第二行 名称
    UILabel *highSpeedRoadcoditionLabel = [[UILabel alloc] initWithFrame:CGRectMake(KContentLeftSizeWidth,
                                                                                    12, 100, 30)];
    highSpeedRoadcoditionLabel.font = KContentLeftTitleFontOfSize;
    highSpeedRoadcoditionLabel.textColor = KDefaultOrNightTextColor;
    highSpeedRoadcoditionLabel.text = @"高速路况";
    highSpeedRoadcoditionLabel.backgroundColor = [UIColor clearColor];
    [highSpeedRoadcoditionButton addSubview:highSpeedRoadcoditionLabel];
    ////第二行    指示箭头
    UIImageView *highSpeedRoadcoditionArrowImageView = [[UIImageView alloc]initWithFrame:CGRectMake(KProjectScreenWidth-25,
                                                                                                    20.5f,
                                                                                                    8.5f,
                                                                                                    13.0f)];
    [highSpeedRoadcoditionArrowImageView setImage:[UIImage imageNamed:@"More_CellArrow.png"]];
    [highSpeedRoadcoditionButton addSubview:highSpeedRoadcoditionArrowImageView];
    [secondSectionView addSubview:highSpeedRoadcoditionButton];
    
    ////分割线
    UIView *secondSectionSeperatorView = [[UIView alloc] initWithFrame:CGRectMake(KContentLeftSizeWidth,
                                                                                  54, 260, 0.5f)];
    secondSectionSeperatorView.backgroundColor = KDefaultOrNightSepratorColor;
    [secondSectionView addSubview:secondSectionSeperatorView];
    
    ////第二行 事故快处
    UIButton *quickDealWthAccidentButton = [UIButton buttonWithType:UIButtonTypeCustom];
    quickDealWthAccidentButton.tag = kQuickDealWthAccidentButtonTag;
    [quickDealWthAccidentButton setBackgroundImage:createImageWithColor([UIColor whiteColor])
                                          forState:UIControlStateNormal];
    [quickDealWthAccidentButton setBackgroundImage:createImageWithColor(KDefaultOrNightButtonHighlightColor)
                                          forState:UIControlStateHighlighted];
    [quickDealWthAccidentButton setFrame:CGRectMake(0, 54.5, KProjectScreenWidth, 54)];
    [quickDealWthAccidentButton addTarget:self action:@selector(initWithUserExploreButtnClicked:)
                         forControlEvents:UIControlEventTouchUpInside];
    [quickDealWthAccidentButton.layer setBorderColor:[KDefaultOrNightSepratorColor CGColor]];
    ////指示图片
    UIImageView *quickDealWthAccidentImageView = [[UIImageView alloc] initWithFrame:CGRectMake(15, 12.5f, 29, 29)];
    quickDealWthAccidentImageView.image = [UIImage imageNamed:@"Me_BreakRules.png"];
    [quickDealWthAccidentButton addSubview:quickDealWthAccidentImageView];
    ////名称
    UILabel *quickDealWthAccidentLabel = [[UILabel alloc] initWithFrame:CGRectMake(KContentLeftSizeWidth,
                                                                                   12, 100, 30)];
    quickDealWthAccidentLabel.font = KContentLeftTitleFontOfSize;
    quickDealWthAccidentLabel.textColor = KDefaultOrNightTextColor;
    quickDealWthAccidentLabel.text = @"违章多发";
#if defined (YT)
    quickDealWthAccidentImageView.image = [UIImage imageNamed:@"Explore_BreakRules.png"];
 #endif
#if defined (JN)
    quickDealWthAccidentImageView.image = [UIImage imageNamed:@"Explore_Accident.png"];
    quickDealWthAccidentLabel.text = @"事故快处";
#endif
    quickDealWthAccidentLabel.backgroundColor = [UIColor clearColor];
    [quickDealWthAccidentButton addSubview:quickDealWthAccidentLabel];
    ////指示箭头
    UIImageView *quickDealWthAccidentArrowImageView = [[UIImageView alloc]initWithFrame:CGRectMake(KProjectScreenWidth-25,
                                                                                                   20.5f, 8.5f, 13.0f)];
    [quickDealWthAccidentArrowImageView setImage:[UIImage imageNamed:@"More_CellArrow.png"]];
    [quickDealWthAccidentButton addSubview:quickDealWthAccidentArrowImageView];
    [secondSectionView addSubview:quickDealWthAccidentButton];
    [mainScrollView addSubview:secondSectionView];
    
    ////////////////
    //第三组部分： 电台资讯、活动召集令
    ////////////////
    
    UIView *thirdSectionView = [[UIView alloc] initWithFrame:CGRectMake(0,253.5, KProjectScreenWidth, 108.5f)];
    //thirdSectionView.backgroundColor = [UIColor whiteColor];
    thirdSectionView.backgroundColor = KDefaultOrNightScrollViewColor;

    thirdSectionView.layer.borderWidth = 0.5f;
    thirdSectionView.layer.borderColor = [KDefaultOrNightSepratorColor CGColor];
    
    //第一行.电台资讯
    UIButton *stationInformaButton = [UIButton buttonWithType:UIButtonTypeCustom];
    stationInformaButton.tag = KstationInformaButtonTag;
    [stationInformaButton setBackgroundImage:createImageWithColor([UIColor whiteColor])
                                    forState:UIControlStateNormal];
    [stationInformaButton setBackgroundImage:createImageWithColor(KDefaultOrNightButtonHighlightColor)
                                    forState:UIControlStateHighlighted];
    [stationInformaButton setFrame:CGRectMake(0, 0.0f, KProjectScreenWidth, 54)];
    [stationInformaButton addTarget:self action:@selector(initWithUserExploreButtnClicked:)
                   forControlEvents:UIControlEventTouchUpInside];
    ////第一行.指示图片
    UIImageView *ustationInfoImageView = [[UIImageView alloc] initWithFrame:CGRectMake(15, 12.5f, 29, 29)];
    ustationInfoImageView.image = [UIImage imageNamed:@"Me_Announcement.png"];
    [stationInformaButton addSubview:ustationInfoImageView];
    ////第一行. 名称
    UILabel *stationInforLabel = [[UILabel alloc] initWithFrame:CGRectMake(KContentLeftSizeWidth, 12, 100, 30)];
    stationInforLabel.font = KContentLeftTitleFontOfSize;
    stationInforLabel.textColor = KDefaultOrNightTextColor;
    stationInforLabel.text = @"电台资讯";
#if defined (YT)
    stationInforLabel.text = @"交管资讯";
#endif
    stationInforLabel.backgroundColor = [UIColor clearColor];
    [stationInformaButton addSubview:stationInforLabel];
    ////第一行. 指示箭头
    UIImageView *stationInformaArrowImageView = [[UIImageView alloc]initWithFrame:CGRectMake(KProjectScreenWidth-25,
                                                                                             20.5f,
                                                                                             8.5f,
                                                                                             13.0f)];
    [stationInformaArrowImageView setImage:[UIImage imageNamed:@"More_CellArrow.png"]];
    [stationInformaButton addSubview:stationInformaArrowImageView];
    [thirdSectionView addSubview:stationInformaButton];
    
    ////分割线
    UIView *usedCarSeperatorView = [[UIView alloc] initWithFrame:CGRectMake(KContentLeftSizeWidth,
                                                                            54.0f, 260, 0.5f)];
    usedCarSeperatorView.backgroundColor = KDefaultOrNightSepratorColor;
    [thirdSectionView addSubview:usedCarSeperatorView];
    
    //第二行.活动召集令
    UIButton *insteadOfDrivingButton = [UIButton buttonWithType:UIButtonTypeCustom];
    insteadOfDrivingButton.tag = KUserActivityLisButtonTag;
    [insteadOfDrivingButton setBackgroundImage:createImageWithColor([UIColor whiteColor])
                                      forState:UIControlStateNormal];
    [insteadOfDrivingButton setBackgroundImage:createImageWithColor(KDefaultOrNightButtonHighlightColor)
                                      forState:UIControlStateHighlighted];
    [insteadOfDrivingButton setFrame:CGRectMake(0, 54.5f, KProjectScreenWidth, 54)];
    [insteadOfDrivingButton addTarget:self action:@selector(initWithUserExploreButtnClicked:)
                     forControlEvents:UIControlEventTouchUpInside];
    ////第二行.指示图片
    UIImageView *insteadOfDrivingImageView = [[UIImageView alloc] initWithFrame:CGRectMake(15,
                                                                                           12.5f,
                                                                                           29, 29)];
    [insteadOfDrivingButton addSubview:insteadOfDrivingImageView];
    ////第二行. 名称
    UILabel *insteadOfDrivingLabel = [[UILabel alloc] initWithFrame:CGRectMake(KContentLeftSizeWidth,
                                                                               12, 100, 30)];
    insteadOfDrivingLabel.font = KContentLeftTitleFontOfSize;
    insteadOfDrivingLabel.textColor = KDefaultOrNightTextColor;
#if defined (NN)
    insteadOfDrivingImageView.image = [UIImage imageNamed:@"Explore_SearchImage.png"];
    insteadOfDrivingLabel.text = @"1074找到了";
#endif
    
#if defined (CS)
    insteadOfDrivingImageView.image = [UIImage imageNamed:@"Explore_SearchImage.png"];
    insteadOfDrivingLabel.text = @"1061找到了";
#endif
    
#if defined (LY)
    insteadOfDrivingImageView.image = [UIImage imageNamed:@"Explore_SearchImage.png"];
    insteadOfDrivingLabel.text = @"899找到了";
#endif
    
#if defined (WH)
    insteadOfDrivingImageView.image = [UIImage imageNamed:@"Explore_SearchImage.png"];
    insteadOfDrivingLabel.text = @"896找到了";
#endif

#if defined (JN)
    insteadOfDrivingImageView.image = [UIImage imageNamed:@"Explore_SearchImage.png"];
    insteadOfDrivingLabel.text = @"1031找到了";
#endif

#if defined (SJC)
    insteadOfDrivingImageView.image = [UIImage imageNamed:@"Explore_DiscloseImage.png"];
    insteadOfDrivingLabel.text = @"啄木鸟在行动";
#endif
#if defined (WF)
    insteadOfDrivingImageView.image = [UIImage imageNamed:@"Explore_LuckyStar.png"];
    insteadOfDrivingLabel.text = @"幸运闪大灯";
#endif
#if defined (YT)
    insteadOfDrivingImageView.image = [UIImage imageNamed:@"Explore_RandomPhoto.png"];
    insteadOfDrivingLabel.text = @"随手拍";
#endif

    insteadOfDrivingLabel.backgroundColor = [UIColor clearColor];
    [insteadOfDrivingButton addSubview:insteadOfDrivingLabel];
    ////第二行. 指示箭头
    UIImageView *insteadOfDrivingArrowImageView = [[UIImageView alloc]initWithFrame:CGRectMake(KProjectScreenWidth-25,
                                                                                               20.5f,
                                                                                               8.5f,
                                                                                               13.0f)];
    [insteadOfDrivingArrowImageView setImage:[UIImage imageNamed:@"More_CellArrow.png"]];
    [insteadOfDrivingButton addSubview:insteadOfDrivingArrowImageView];
    [thirdSectionView addSubview:insteadOfDrivingButton];
    [mainScrollView addSubview:thirdSectionView];
    ///////////////////
    //第四部分： 周边商户
    //////////////////
    //1.周边商户
    UIView *footSectionView= [[UIView alloc] initWithFrame:CGRectMake(0, 387.0f, KProjectScreenWidth, 54)];
    //footSectionView.backgroundColor = [UIColor whiteColor];
    footSectionView.backgroundColor = KDefaultOrNightScrollViewColor;

    footSectionView.layer.borderWidth = 0.5f;
    footSectionView.layer.borderColor = [KDefaultOrNightSepratorColor CGColor];
    
    UIButton *nearbyShopButton = [UIButton buttonWithType:UIButtonTypeCustom];
    nearbyShopButton.tag = kNearbyShopButtonTag;
    [nearbyShopButton setBackgroundImage:createImageWithColor(KDefaultOrNightBackGroundColor)
                                forState:UIControlStateNormal];
    [nearbyShopButton setBackgroundImage:createImageWithColor(KDefaultOrNightButtonHighlightColor)
                                forState:UIControlStateHighlighted];
    [nearbyShopButton setFrame:CGRectMake(0, 0, KProjectScreenWidth, 54)];
    [nearbyShopButton addTarget:self action:@selector(initWithUserExploreButtnClicked:)
               forControlEvents:UIControlEventTouchUpInside];
    [nearbyShopButton.layer setBorderWidth:0.5f];
    [nearbyShopButton.layer setBorderColor:[KDefaultOrNightSepratorColor CGColor]];
    ////指示图片
    UIImageView *nearbyShopImageView = [[UIImageView alloc] initWithFrame:CGRectMake(15, 12.5f, 29, 29)];
    nearbyShopImageView.image = [UIImage imageNamed:@"Explore_NearbyShop.png"];
    [nearbyShopButton addSubview:nearbyShopImageView];
    ////名称
    UILabel *nearbyShopLabel = [[UILabel alloc] initWithFrame:CGRectMake(KContentLeftSizeWidth,
                                                                         12, 100, 30)];
    nearbyShopLabel.font = KContentLeftTitleFontOfSize;
    nearbyShopLabel.textColor = KDefaultOrNightTextColor;
    nearbyShopLabel.backgroundColor = [UIColor clearColor];
    nearbyShopLabel.text = @"特约商户";
    
#if  defined (YT)
    nearbyShopImageView.image = [UIImage imageNamed:@"Explore_PoliceMessage.png"];
    nearbyShopLabel.text = @"交警留言板";
#endif
    [nearbyShopButton addSubview:nearbyShopLabel];
    ////指示箭头
    UIImageView *nearbyShopArrowImageView = [[UIImageView alloc]initWithFrame:CGRectMake(KProjectScreenWidth-25,
                                                                                         20.5f, 8.5f, 13.0f)];
    [nearbyShopArrowImageView setImage:[UIImage imageNamed:@"More_CellArrow.png"]];
    [nearbyShopButton addSubview:nearbyShopArrowImageView];
    [footSectionView addSubview:nearbyShopButton];
    [mainScrollView addSubview:footSectionView];
    
    [self.view addSubview:mainScrollView];
}

- (void)initWithUserExploreButtnClicked:(id)sender{
    UIButton    *button = (UIButton *)sender;
    
    //摇一摇按键定位
    if (button.tag == KUserShakeAndShakeButtonTag) {
        
        if ([[CurrentUserInformation sharedCurrentUserInfo] userLoginState] == 0) {//未登录
            //注册控制器
            LoginController *registerController = [[LoginController alloc] init];
            FMNavigationController *navController = [[FMNavigationController alloc] initWithRootViewController:registerController];
            [self presentModalViewController:navController animated:YES];
        }else{//用户已经登录
            UserShakeMainController *insteadOfDirvierView = [[UserShakeMainController alloc]initWithViewControlTyle:InitNavigationStyle];
            insteadOfDirvierView.hidesBottomBarWhenPushed = YES;
            [self.navigationController pushViewController:insteadOfDirvierView animated:YES];
        }
    }
    
    //电台活动按键定位
    else if (button.tag == KRadioActivityButtonTag){
        BroadcastinStationActivityView  *broadcastInStationView = [[BroadcastinStationActivityView alloc]init];
        broadcastInStationView.hidesBottomBarWhenPushed = YES;
        [self.navigationController pushViewController:broadcastInStationView animated:YES];
        
        UIImageView *hintImageView = (UIImageView *)[button viewWithTag:KPushRadioActivityNewInforImageTag];
        if (hintImageView) {
            [hintImageView setHidden:YES];
        }
        [FMShareSetting setAppPushRadioActivityBool:NO];
        
        if (FMShareSetting.appPushPrizeListInforBool == NO) {
            AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
            FMTabBarController* tabControl = (FMTabBarController*)appDelegate.window.rootViewController;
            [tabControl showHintPoint:2 showOrHide:NO];
        }
    }
    
    ///进入更多引导
    else if (button.tag == KMoreButtonTag){
        MoreForExploreViewController *moreViewController = [[MoreForExploreViewController alloc]init];
        moreViewController.hidesBottomBarWhenPushed = YES;
        [self.navigationController pushViewController:moreViewController animated:YES];
    }
    
    //高速路况按键定位
    else if (button.tag == kHighSpeedRoadcoditionButtonTag){
        ShareWebViewController *webControler = [[ShareWebViewController alloc]initWithWebURLString:[NSString stringWithFormat:@"%@Freeway/conditionShare?id=0&uid=%@&source=%@",kBaseAPIURL,[CurrentUserInformation sharedCurrentUserInfo].userLoginState !=0 ?[CurrentUserInformation sharedCurrentUserInfo].userID:@"0",KProjectCityCodeString] withTitle:@"高速路况" withStyle:InitNavigationWebStyle withImageInfor:[UIImage imageNamed:FMCZFWLogoImage] withShareWebDataStyle:WebDataForHighSpeedRoadStyle withDataInforID:@""];
        [webControler setIsNeedShareWebInfor:YES];
        [webControler setHidesBottomBarWhenPushed:YES];
        
        Log(@"%@",[NSString stringWithFormat:@"%@Freeway/conditionShare?id=0&uid=%@&source=%@",kBaseAPIURL,[CurrentUserInformation sharedCurrentUserInfo].userLoginState !=0 ?[CurrentUserInformation sharedCurrentUserInfo].userID:@"0",KProjectCityCodeString]);
        [self.navigationController pushViewController:webControler animated:YES];
    }
    //事故快处按键定位
    else if (button.tag == kQuickDealWthAccidentButtonTag){
    
#if defined (JN)
        QuickDealWithAccidentController *accidentViewController = [[QuickDealWithAccidentController alloc]init];
        [accidentViewController setHidesBottomBarWhenPushed:YES];
        [self.navigationController pushViewController:accidentViewController animated:YES];
#else
        MultipleBreakRulesMainView  *rulesMainView = [[MultipleBreakRulesMainView alloc]init];
        [rulesMainView setHidesBottomBarWhenPushed:YES];
        [self.navigationController pushViewController:rulesMainView animated:YES];
   
#endif
        
    }
    
    
    //电台资讯按键定位
    else if (button.tag == KstationInformaButtonTag){
        
        AnnouncementViewController *announcementController = [[AnnouncementViewController alloc] init];
        announcementController.hidesBottomBarWhenPushed = YES;
        [self.navigationController setNavigationBarHidden:NO animated:NO];//显示导航栏
        [self.navigationController pushViewController:announcementController animated:YES];
        
        UIImageView *hintImageView = (UIImageView *)[button viewWithTag:KPushRadioInformationNewInforImageTag];
        if (hintImageView) {
            [hintImageView setHidden:YES];
        }
        [FMShareSetting setAppPushRadioAnnouncementBool:NO];
    }
    
    //活动召集令按键定位
    else if (button.tag == KUserActivityLisButtonTag){
        
        if ([[CurrentUserInformation sharedCurrentUserInfo] userLoginState] == 0) {//未登录
            //注册控制器
            LoginController *registerController = [[LoginController alloc] init];
            FMNavigationController *navController = [[FMNavigationController alloc] initWithRootViewController:registerController];
            [self presentModalViewController:navController animated:YES];
        }else{//用户已经登录
            
#if defined (NN)||(JN)||(WH)||(LY)||(CS)
       SearchAndReceiveViewController *searchReceiveView = [[SearchAndReceiveViewController alloc]init];
            [searchReceiveView setHidesBottomBarWhenPushed:YES];
            [self.navigationController pushViewController:searchReceiveView animated:YES];
#endif

            
#if defined (SJC)
            if ([[CurrentUserInformation sharedCurrentUserInfo] userLoginState] == 0) {//未登录
                //注册控制器
                LoginController *registerController = [[LoginController alloc] init];
                FMNavigationController *navController = [[FMNavigationController alloc] initWithRootViewController:registerController];
                [self presentModalViewController:navController animated:YES];
            }else{//用户已经登录
                
                ExposureFreshThingViewController *viewController = [[ExposureFreshThingViewController alloc]init];
                [viewController setHidesBottomBarWhenPushed:YES];
                [self.navigationController pushViewController:viewController animated:YES];        }
#endif
#if defined (WF)
            LuckUserGetCodewordsViewController  *viewController = [[LuckUserGetCodewordsViewController alloc]init];
            [viewController setHidesBottomBarWhenPushed:YES];
            [self.navigationController pushViewController:viewController animated:YES];
         
#endif
#if defined (YT)
            RandomPhotoViewController *randomPhotoView = [[RandomPhotoViewController alloc]init];
            [randomPhotoView setHidesBottomBarWhenPushed:YES];
            [self.navigationController pushViewController:randomPhotoView animated:YES];
#endif

        }
        
    }
    
    //周边商户按键定位
    else if (button.tag == kNearbyShopButtonTag){
#if defined (YT)
        if ([CurrentUserInformation sharedCurrentUserInfo].userLoginState == 0) {
            //登陆控制器
            LoginController *loginController = [[LoginController alloc] init];
            FMNavigationController *navController = [[FMNavigationController alloc] initWithRootViewController:loginController];
            [self presentModalViewController:navController animated:YES];
        } else {
            
            UIImageView *hintImageView = (UIImageView *)[button viewWithTag:KPushSpecialBusinessNewImageViewTag];
            if (hintImageView) {
                [hintImageView setHidden:YES];
            }
            [FMShareSetting setAppPushExploreSpecialBusinessInforBool:NO];
            
            TrafficPoliceMessageViewController *policeMessageView = [[TrafficPoliceMessageViewController alloc]init];
            policeMessageView.hidesBottomBarWhenPushed = YES;
            [self.navigationController pushViewController:policeMessageView animated:YES];
        }
    }
    
        
#else
        UIImageView *hintImageView = (UIImageView *)[button viewWithTag:KPushSpecialBusinessNewImageViewTag];
        if (hintImageView) {
            [hintImageView setHidden:YES];
        }
        [FMShareSetting setAppPushExploreSpecialBusinessInforBool:NO];
        
        NearbyMerchantList *viewController = [[NearbyMerchantList alloc]init];
        viewController.hidesBottomBarWhenPushed = YES;
        [self.navigationController pushViewController:viewController animated:YES];
    }
#endif
}

- (void)haveRead{
    
}

//- (void)initWithUserReadShakePrizeListNotification:(NSNotification *)notification{
////    UIScrollView *mainScrollView = (UIScrollView *)[self.view viewWithTag:kScrollViewTag];
////    UIButton *buttonShake = (UIButton *)[mainScrollView viewWithTag:KUserShakeAndShakeButtonTag];
////    UIImageView *shakeNewImageView = (UIImageView *)[buttonShake viewWithTag:KPushShakeAndShakeNewPrizeImageTag];
////    [shakeNewImageView setHidden:YES];
////    [FMShareSetting setAppPushPrizeListInforBool:NO];
////    
////    if (FMShareSetting.appPushRadioActivityBool == NO) {
////        AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];
////        FMTabBarController* tabControl = (FMTabBarController*)appDelegate.window.rootViewController;
////        [tabControl showHintPoint:2 showOrHide:NO];
////    }
//}

- (void)initWithUSerSecondHandCarResultInforNotification:(NSNotification *)notification{
    UIScrollView *mainScrollView = (UIScrollView *)[self.view viewWithTag:kScrollViewTag];
    UIButton *buttonShake = (UIButton *)[mainScrollView viewWithTag:KMoreButtonTag];
    UIImageView *shakeNewImageView = (UIImageView *)[buttonShake viewWithTag:KPushSecondHandCarResultImageViewTag];
    [shakeNewImageView setHidden:YES];
    [FMShareSetting setAppPushExploreSecondCarResultInforBool:NO];
}
#pragma mark -主题通知
- (void) themeChangedNotification:(NSNotification *)notification
{
    [self updateNaviTheme];
    [self ThemeForNight];


}
@end